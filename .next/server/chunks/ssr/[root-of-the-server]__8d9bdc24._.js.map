{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["file:///Users/josh3.0/projects/chemmos/prop-management/lib/firebase.ts"],"sourcesContent":["import { initializeApp } from \"firebase/app\";\nimport { getAuth } from \"firebase/auth\";\nimport { getFirestore } from \"firebase/firestore\";\nimport { getStorage } from \"firebase/storage\";\n\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n};\n\nconst app = initializeApp(firebaseConfig);\n\nexport const auth = getAuth(app);\nexport const db = getFirestore(app);\nexport const storage = getStorage(app);\n"],"names":[],"mappings":";;;;;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;AAEA,MAAM,iBAAiB;IACrB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;AACP;AAEA,MAAM,MAAM,CAAA,GAAA,oLAAA,CAAA,gBAAa,AAAD,EAAE;AAEnB,MAAM,OAAO,CAAA,GAAA,6MAAA,CAAA,UAAO,AAAD,EAAE;AACrB,MAAM,KAAK,CAAA,GAAA,iKAAA,CAAA,eAAY,AAAD,EAAE;AACxB,MAAM,UAAU,CAAA,GAAA,oLAAA,CAAA,aAAU,AAAD,EAAE","debugId":null}},
    {"offset": {"line": 170, "column": 0}, "map": {"version":3,"sources":["file:///Users/josh3.0/projects/chemmos/prop-management/context/AuthContext.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ReactNode,\n  createContext,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\nimport { onAuthStateChanged, User } from \"firebase/auth\";\nimport { auth, db } from \"@/lib/firebase\";\nimport { doc, getDoc, setDoc, serverTimestamp } from \"firebase/firestore\";\n\ninterface AppUser {\n  uid: string;\n  email: string | null;\n  role: \"admin\" | \"user\" | \"tenant\"; // extendable\n  [key: string]: any;\n}\n\ninterface AuthContextType {\n  user: User | null;\n  appUser: AppUser | null;\n  loading: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType>({\n  user: null,\n  appUser: null,\n  loading: true,\n});\n\nexport const AuthProvider = ({ children }: { children: ReactNode }) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [appUser, setAppUser] = useState<AppUser | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (firebaseUser) => {\n      setUser(firebaseUser);\n      if (firebaseUser) {\n        const userRef = doc(db, \"users\", firebaseUser.uid);\n        const userSnap = await getDoc(userRef);\n\n        if (!userSnap.exists()) {\n          // ðŸ‘¤ Create default user profile in Firestore\n          const defaultRole =\n            firebaseUser.email === \"admin@example.com\" ? \"admin\" : \"user\"; // or 'tenant'\n          const newUser: AppUser = {\n            uid: firebaseUser.uid,\n            email: firebaseUser.email,\n            role: defaultRole,\n            createdAt: serverTimestamp(),\n          };\n          await setDoc(userRef, newUser);\n          setAppUser(newUser);\n        } else {\n          setAppUser(userSnap.data() as AppUser);\n        }\n      } else {\n        setAppUser(null);\n      }\n\n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  return (\n    <AuthContext.Provider value={{ user, appUser, loading }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => useContext(AuthContext);\n"],"names":[],"mappings":";;;;;AAEA;AAOA;AAAA;AACA;AACA;AAAA;AAXA;;;;;;AA0BA,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,gBAAa,AAAD,EAAmB;IACjD,MAAM;IACN,SAAS;IACT,SAAS;AACX;AAEO,MAAM,eAAe,CAAC,EAAE,QAAQ,EAA2B;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAe;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAkB;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,cAAc,CAAA,GAAA,wNAAA,CAAA,qBAAkB,AAAD,EAAE,+GAAA,CAAA,OAAI,EAAE,OAAO;YAClD,QAAQ;YACR,IAAI,cAAc;gBAChB,MAAM,UAAU,CAAA,GAAA,iKAAA,CAAA,MAAG,AAAD,EAAE,+GAAA,CAAA,KAAE,EAAE,SAAS,aAAa,GAAG;gBACjD,MAAM,WAAW,MAAM,CAAA,GAAA,iKAAA,CAAA,SAAM,AAAD,EAAE;gBAE9B,IAAI,CAAC,SAAS,MAAM,IAAI;oBACtB,8CAA8C;oBAC9C,MAAM,cACJ,aAAa,KAAK,KAAK,sBAAsB,UAAU,QAAQ,cAAc;oBAC/E,MAAM,UAAmB;wBACvB,KAAK,aAAa,GAAG;wBACrB,OAAO,aAAa,KAAK;wBACzB,MAAM;wBACN,WAAW,CAAA,GAAA,iKAAA,CAAA,kBAAe,AAAD;oBAC3B;oBACA,MAAM,CAAA,GAAA,iKAAA,CAAA,SAAM,AAAD,EAAE,SAAS;oBACtB,WAAW;gBACb,OAAO;oBACL,WAAW,SAAS,IAAI;gBAC1B;YACF,OAAO;gBACL,WAAW;YACb;YAEA,WAAW;QACb;QAEA,OAAO,IAAM;IACf,GAAG,EAAE;IAEL,qBACE,8OAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAS;QAAQ;kBACnD;;;;;;AAGP;AAEO,MAAM,UAAU,IAAM,CAAA,GAAA,qMAAA,CAAA,aAAU,AAAD,EAAE","debugId":null}}]
}