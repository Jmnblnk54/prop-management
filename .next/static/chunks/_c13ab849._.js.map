{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/josh3.0/projects/chemmos/prop-management/lib/firebase.ts"],"sourcesContent":["import { initializeApp } from \"firebase/app\";\nimport { getAuth } from \"firebase/auth\";\nimport { getFirestore } from \"firebase/firestore\";\nimport { getStorage } from \"firebase/storage\";\n\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n};\n\nconst app = initializeApp(firebaseConfig);\n\nexport const auth = getAuth(app);\nexport const db = getFirestore(app);\nexport const storage = getStorage(app);\n"],"names":[],"mappings":";;;;;AAMU;AANV;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;AAEA,MAAM,iBAAiB;IACrB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;AACP;AAEA,MAAM,MAAM,CAAA,GAAA,uLAAA,CAAA,gBAAa,AAAD,EAAE;AAEnB,MAAM,OAAO,CAAA,GAAA,6MAAA,CAAA,UAAO,AAAD,EAAE;AACrB,MAAM,KAAK,CAAA,GAAA,sKAAA,CAAA,eAAY,AAAD,EAAE;AACxB,MAAM,UAAU,CAAA,GAAA,oKAAA,CAAA,aAAU,AAAD,EAAE","debugId":null}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/josh3.0/projects/chemmos/prop-management/context/AuthContext.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ReactNode,\n  createContext,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\nimport { onAuthStateChanged, User } from \"firebase/auth\";\nimport { auth, db } from \"@/lib/firebase\";\nimport { doc, getDoc, setDoc, serverTimestamp } from \"firebase/firestore\";\n\ninterface AppUser {\n  uid: string;\n  email: string | null;\n  role: \"admin\" | \"user\" | \"tenant\"; // extendable\n  [key: string]: any;\n}\n\ninterface AuthContextType {\n  user: User | null;\n  appUser: AppUser | null;\n  loading: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType>({\n  user: null,\n  appUser: null,\n  loading: true,\n});\n\nexport const AuthProvider = ({ children }: { children: ReactNode }) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [appUser, setAppUser] = useState<AppUser | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (firebaseUser) => {\n      setUser(firebaseUser);\n      if (firebaseUser) {\n        const userRef = doc(db, \"users\", firebaseUser.uid);\n        const userSnap = await getDoc(userRef);\n\n        if (!userSnap.exists()) {\n          // ðŸ‘¤ Create default user profile in Firestore\n          const defaultRole =\n            firebaseUser.email === \"admin@example.com\" ? \"admin\" : \"user\"; // or 'tenant'\n          const newUser: AppUser = {\n            uid: firebaseUser.uid,\n            email: firebaseUser.email,\n            role: defaultRole,\n            createdAt: serverTimestamp(),\n          };\n          await setDoc(userRef, newUser);\n          setAppUser(newUser);\n        } else {\n          setAppUser(userSnap.data() as AppUser);\n        }\n      } else {\n        setAppUser(null);\n      }\n\n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  return (\n    <AuthContext.Provider value={{ user, appUser, loading }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => useContext(AuthContext);\n"],"names":[],"mappings":";;;;;AAEA;AAOA;AAAA;AACA;AACA;AAAA;;;AAXA;;;;;AA0BA,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,gBAAa,AAAD,EAAmB;IACjD,MAAM;IACN,SAAS;IACT,SAAS;AACX;AAEO,MAAM,eAAe,CAAC,EAAE,QAAQ,EAA2B;;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAe;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAkB;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;kCAAE;YACR,MAAM,cAAc,CAAA,GAAA,wNAAA,CAAA,qBAAkB,AAAD,EAAE,kHAAA,CAAA,OAAI;sDAAE,OAAO;oBAClD,QAAQ;oBACR,IAAI,cAAc;wBAChB,MAAM,UAAU,CAAA,GAAA,sKAAA,CAAA,MAAG,AAAD,EAAE,kHAAA,CAAA,KAAE,EAAE,SAAS,aAAa,GAAG;wBACjD,MAAM,WAAW,MAAM,CAAA,GAAA,sKAAA,CAAA,SAAM,AAAD,EAAE;wBAE9B,IAAI,CAAC,SAAS,MAAM,IAAI;4BACtB,8CAA8C;4BAC9C,MAAM,cACJ,aAAa,KAAK,KAAK,sBAAsB,UAAU,QAAQ,cAAc;4BAC/E,MAAM,UAAmB;gCACvB,KAAK,aAAa,GAAG;gCACrB,OAAO,aAAa,KAAK;gCACzB,MAAM;gCACN,WAAW,CAAA,GAAA,sKAAA,CAAA,kBAAe,AAAD;4BAC3B;4BACA,MAAM,CAAA,GAAA,sKAAA,CAAA,SAAM,AAAD,EAAE,SAAS;4BACtB,WAAW;wBACb,OAAO;4BACL,WAAW,SAAS,IAAI;wBAC1B;oBACF,OAAO;wBACL,WAAW;oBACb;oBAEA,WAAW;gBACb;;YAEA;0CAAO,IAAM;;QACf;iCAAG,EAAE;IAEL,qBACE,6LAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAS;QAAQ;kBACnD;;;;;;AAGP;GA1Ca;KAAA;AA4CN,MAAM,UAAU;;IAAM,OAAA,CAAA,GAAA,6JAAA,CAAA,aAAU,AAAD,EAAE;AAAW;IAAtC","debugId":null}}]
}